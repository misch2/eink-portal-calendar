@model Display
@using PortalCalendarServer.Services
@using PortalCalendarServer.Models.Entities

@{
    var themes = (List<Theme>)ViewData["Themes"]!;
    var displayService = (DisplayService)ViewData["DisplayService"]!;
}

@if (!Model.IsDefault())
{
    <fieldset class="row mb-3">
        <legend class="w-auto">Name (title)</legend>
        <div class="col-md-12">
            <input id="display_name" name="display_name" type="text" class="form-control" value="@Model.Name">
        </div>
    </fieldset>

    <fieldset class="row mb-4">
        <legend class="w-auto">Theme</legend>
        <div class="col-md-12">
            <select id="theme_id" name="theme_id" class="form-select">
                <option value=""></option>
                @foreach (var theme in themes)
                {
                    <option value="@theme.Id"
                            data-has-config="@theme.HasCustomConfig.ToString().ToLower()"
                            selected="@(Model.ThemeId == theme.Id)">
                        @theme.DisplayName
                    </option>
                }
            </select>
        </div>

        <!-- Theme customization section - indented and styled to show it belongs to Theme -->
        <div class="col-md-12 mt-3">
            <div class="card border-start border-primary border-3 bg-light">
                <div class="card-body">
                    <h6 class="card-subtitle mb-3 text-muted">
                        <i class="bi bi-gear"></i> Theme-specific Settings
                    </h6>
                    <div id="theme-customization" class="row">
                        <div class="col-12">
                            <small>Select a theme above to see available customization options</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>
}

<fieldset class="row mb-3">
    <legend class="w-auto">Location and locale</legend>
    <div class="form-group row">
        <div class="col-md-4">
            <label for="lat">Latitude (+N/-S)</label>
            <input id="lat" name="lat" type="text" class="form-control"
                   value="@displayService.GetConfigWithoutDefaults(Model, "lat")"
                   placeholder="@displayService.GetConfigDefaultsOnly("lat")">
        </div>
        <div class="col-md-4">
            <label for="lon">Longitude (+E/-W)</label>
            <input id="lon" name="lon" type="text" class="form-control"
                   value="@displayService.GetConfigWithoutDefaults(Model, "lon")"
                   placeholder="@displayService.GetConfigDefaultsOnly("lon")">
        </div>
        <div class="col-md-4">
            <label for="alt">Altitude (m)</label>
            <input id="alt" name="alt" type="text" class="form-control"
                   value="@displayService.GetConfigWithoutDefaults(Model, "alt")"
                   placeholder="@displayService.GetConfigDefaultsOnly("alt")">
        </div>
    </div>
    <div class="form-group row mt-2">
        <div class="col-md-4">
            <label for="timezone">Time Zone</label>
            <input id="timezone" name="timezone" type="text" class="form-control"
                   value="@displayService.GetConfigWithoutDefaults(Model, "timezone")"
                   placeholder="@displayService.GetConfigDefaultsOnly("timezone")">
        </div>
        <div class="col-md-4">
            <label for="date_culture">Date style</label>
            <select id="date_culture" name="date_culture" class="form-select">
                @if (!Model.IsDefault())
                {
                    <option value="" disabled selected="@(String.IsNullOrEmpty(displayService.GetConfigWithoutDefaults(Model, "date_culture")))">(@displayService.GetConfigDefaultsOnly("date_culture") - default)</option>
                }
                @foreach (var val in new[] { "en-US", "cs-CZ" })
                {
                    <option value="@val" selected="@(displayService.GetConfigWithoutDefaults(Model, "date_culture") == val)">@val</option>
                }
            </select>
        </div>
    </div>
</fieldset>
