@model PortalCalendarServer.Models.Entities.Display
@using PortalCalendarServer.Services

@{
    var displayService = (DisplayService)ViewData["DisplayService"]!;
}

<fieldset class="row mb-3">
    <div class="col-md-12">
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="ota_mode" name="ota_mode" value="1"
                   checked="@(displayService.GetConfig("ota_mode") == "1")">
            <label class="form-check-label" for="ota_mode">OTA mode on</label>
        </div>
        <div class="form-text">
            (Required for firmware update. ⚠️ It disables standard functionality and waits for OTA update indefinitely until a manual reset or a successful firmware download!)
        </div>
    </div>
</fieldset>

@if (!Model.IsDefault())
{
    <fieldset class="row mb-3">
        <div class="col-md-12">
            <label for="display_mac">MAC address</label>
            <input id="display_mac" name="display_mac" type="text" class="form-control" value="@Model.Mac">
            <div class="form-text">MAC address of the display in the aa:bb:cc:dd:ee:ff format.</div>
        </div>
    </fieldset>

    <fieldset class="row mb-3">
        <div class="col-md-6">
            <label for="display_rotation">Rotation</label>
            <select id="display_rotation" name="display_rotation" class="form-select">
                <option value="0" selected="@(Model.Rotation == 0)">0° (@Model.Width × @Model.Height)</option>
                <option value="1" selected="@(Model.Rotation == 1)">90° (@Model.Height × @Model.Width)</option>
                <option value="2" selected="@(Model.Rotation == 2)">180° (@Model.Width × @Model.Height but upside down)</option>
                <option value="3" selected="@(Model.Rotation == 3)">270° (@Model.Height × @Model.Width)</option>
            </select>
        </div>
        <div class="col-md-6">
            <label for="display_gamma">Gamma</label>
            <input id="display_gamma" name="display_gamma" type="number" step="0.01" class="form-control" value="@Model.Gamma">
            <div class="form-text">How should the grayscale/antialiased elements map to the pure black and white. Higher values &gt; 2.2 = darker and thicker, lower values &lt; 1.8 = lighter and thinner.</div>
        </div>
    </fieldset>

    <fieldset class="row mb-3">
        <div class="col-md-3">
            <label for="display_border_top">Preview frame top</label>
            <input id="display_border_top" name="display_border_top" type="number" step="1" class="form-control" value="@Model.BorderTop">
        </div>
        <div class="col-md-3">
            <label for="display_border_right">Preview frame right</label>
            <input id="display_border_right" name="display_border_right" type="number" step="1" class="form-control" value="@Model.BorderRight">
        </div>
        <div class="col-md-3">
            <label for="display_border_bottom">Preview frame bottom</label>
            <input id="display_border_bottom" name="display_border_bottom" type="number" step="1" class="form-control" value="@Model.BorderBottom">
        </div>
        <div class="col-md-3">
            <label for="display_border_left">Preview frame left</label>
            <input id="display_border_left" name="display_border_left" type="number" step="1" class="form-control" value="@Model.BorderLeft">
        </div>
        <div class="col-md-12 form-text">
            Preview frame border (how much the physical frame overlaps the display on each side)
        </div>
    </fieldset>
}

<fieldset class="row mb-3">
    <div class="col-md-4">
        <label for="wakeup_schedule">Wake up (redraw) schedule</label>
        <input id="wakeup_schedule" name="wakeup_schedule" type="text" class="form-control"
               value="@displayService.GetConfigWithoutDefaults("wakeup_schedule")"
               placeholder="@displayService.GetConfigDefaultsOnly("wakeup_schedule")">
        <div class="form-text">Schedule is in the <a href="https://crontab.guru/">crontab format</a>, for example "0 * * * *"</div>
    </div>
    <div class="col-md-4">
        <label for="alive_check_safety_lag_minutes">Enforced lag when checking if display is alive (minutes)</label>
        <input id="alive_check_safety_lag_minutes" name="alive_check_safety_lag_minutes" type="number" class="form-control"
               value="@displayService.GetConfigWithoutDefaults("alive_check_safety_lag_minutes")"
               placeholder="@displayService.GetConfigDefaultsOnly("alive_check_safety_lag_minutes")">
        <div class="form-text">How many minutes to delay the check after the expected contact time</div>
    </div>
    <div class="col-md-4">
        <label for="alive_check_minimal_failure_count">Min. number of alive check failures</label>
        <input id="alive_check_minimal_failure_count" name="alive_check_minimal_failure_count" type="number" class="form-control"
               value="@displayService.GetConfigWithoutDefaults("alive_check_minimal_failure_count")"
               placeholder="@displayService.GetConfigDefaultsOnly("alive_check_minimal_failure_count")">
        <div class="form-text">Minimal number of failures the display is considered to be frozen and before a notification is sent.</div>
    </div>
</fieldset>
